position = 0,
range = c(0, 743807.368421),
rangemode = "normal",
showexponent = "all",
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tick0 = 0,
tickangle = "auto",
tickcolor = "#444",
tickfont = list(
color = "",
family = "",
size = 0
),
ticklen = 5,
ticks = "",
tickwidth = 1,
title = "Click to enter Y axis title",
titlefont = list(
color = "",
family = "",
size = 0
),
type = "linear",
zeroline = TRUE,
zerolinecolor = "#444",
zerolinewidth = 1
),
yaxis2 = list(
anchor = "x2",
autorange = TRUE,
autotick = TRUE,
domain = c(0.55, 1),
dtick = 10,
exponentformat = "B",
gridcolor = "#eee",
gridwidth = 1,
linecolor = "#444",
linewidth = 1,
mirror = FALSE,
nticks = 0,
overlaying = FALSE,
position = 0,
range = c(0, 30.5263157895),
rangemode = "normal",
showexponent = "all",
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tick0 = 0,
tickangle = "auto",
tickcolor = "#444",
tickfont = list(
color = "",
family = "",
size = 0
),
ticklen = 5,
ticks = "",
tickwidth = 1,
title = "Click to enter Y2 axis title",
titlefont = list(
color = "",
family = "",
size = 0
),
type = "linear",
zeroline = TRUE,
zerolinecolor = "#444",
zerolinewidth = 1
),
yaxis3 = list(
anchor = "x3",
autorange = TRUE,
autotick = TRUE,
domain = c(0.2475, 0.45),
dtick = 5,
exponentformat = "B",
gridcolor = "#eee",
gridwidth = 1,
linecolor = "#444",
linewidth = 1,
mirror = FALSE,
nticks = 0,
overlaying = FALSE,
position = 0,
range = c(0, 20.4210227493),
rangemode = "normal",
showexponent = "all",
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tick0 = 0,
tickangle = "auto",
tickcolor = "#444",
tickfont = list(
color = "",
family = "",
size = 0
),
ticklen = 5,
ticks = "",
tickwidth = 1,
title = "Click to enter Y3 axis title",
titlefont = list(
color = "",
family = "",
size = 0
),
type = "linear",
zeroline = TRUE,
zerolinecolor = "#444",
zerolinewidth = 1
)
)
response <- py$plotly(data, kwargs=list(layout=layout))
py$plotly(data, kwargs=list(layout=layout))
py
py <- plotly(username='charleyferrari', key='oksysax3g0')
install.packages("plot_ly")
library(Rtools)
install.packages("devtools")
install.packages("Rtools")
install.packages("bigvis")
devtools::install_github("hadley/bigvis")
library(bigvis)
install.packages("Rcpp")
install.packages("Rcpp")
library(bigvis)
devtools::find_rtools()
iris
iris <- iris
py <- plotly(username='charleyferrari', key='oksysax3g0')
install.packages("plotly")
library(plotly)
py <- plotly(username='charleyferrari', key='oksysax3g0')
dsamp <- diamonds[sample(nrow(diamonds), 1000), ]
qplot(carat, price, data=dsamp, colour=clarity)
ggplotly()
qplot(carat, price, data=dsamp, colour=clarity)
ggplotly()
q <- qplot(carat, price, data=dsamp, colour=clarity)
q <- ggplotly(q)
plot_ly(q)
py <- plot_ly(username='charleyferrari', key='oksysax3g0')
?plot_ly
plot_ly(q)
?plot_ly
plotly_POST(q)
View(q)
q <- qplot(carat, price, data=dsamp, colour=clarity)
q
q <- ggplotly(q)
plot_ly(q)
ggplotly(q)
q <- qplot(carat, price, data=dsamp, colour=clarity)
ggplotly(q)
install.packages("faraway")
library(faraway)
pima
summary(pima)
sort(pima$diastolic)
pima$diastolic[pima$diastolic == 0] <- NA
pima$test <- factor(pima$test)
levels(pima$test)
levels(pima$test) <- c('negative', 'positive')
hist(pima$diastolic)
plot(density(pima$diastolic, na.rm = TRUE))
library(ggplot2)
# library(MASS)
library(knitr)
library(dplyr)
setwd("/Users/Charley/Downloads/cuny/IS 621 Business Analytics and Data Mining/Homework 1")
cigarettes <- read.csv("cigarette-training-data.csv")
northeast <- c("ME", "NH", "VT", "MA", "RI", "CT", "NY", "PA", "NJ")
midwest <- c("ND", "SD", "NE", "KS", "MN", "IA", "MO", "IL", "WI", "MI",
"IN", "OH", "IO", "KA", "NB")
south <- c("DE", "MD", "DC", "WV", "VA", "KY", "NC", "TN", "SC", "GA",
"AL","MS","AR","LA","OK","TX", "FL")
west <- c("WA", "OR", "ID", "MT", "WY", "CA", "NV", "UT", "CO", "AZ", "NM", "AK", "HI")
regionlookup <- rbind(data.frame(Region = "Northeast", State = northeast),
data.frame(Region = "Midwest", State = midwest),
data.frame(Region = "South", State = south),
data.frame(Region = "West", State = west))
cigarettesregion <- merge(cigarettes,regionlookup, by="State")
filteredcigarettes <- filter(cigarettes, Sales < 135 & Sales > 82)
filteredcigarettesregion <- merge(filteredcigarettes,regionlookup, by="State")
rm(midwest, northeast, south, west, regionlookup)
# Multiple plot function
#
# ggplot objects can be passed in ..., or to plotlist (as a list of ggplot objects)
# - cols:   Number of columns in layout
# - layout: A matrix specifying the layout. If present, 'cols' is ignored.
#
# If the layout is something like matrix(c(1,2,3,3), nrow=2, byrow=TRUE),
# then plot 1 will go in the upper left, 2 will go in the upper right, and
# 3 will go all the way across the bottom.
#
multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
library(grid)
# Make a list from the ... arguments and plotlist
plots <- c(list(...), plotlist)
numPlots = length(plots)
# If layout is NULL, then use 'cols' to determine layout
if (is.null(layout)) {
# Make the panel
# ncol: Number of columns of plots
# nrow: Number of rows needed, calculated from # of cols
layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
ncol = cols, nrow = ceiling(numPlots/cols))
}
if (numPlots==1) {
print(plots[[1]])
} else {
# Set up the page
grid.newpage()
pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
# Make each plot, in the correct location
for (i in 1:numPlots) {
# Get the i,j matrix positions of the regions that contain this subplot
matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
layout.pos.col = matchidx$col))
}
}
}
d1 <- ggplot(cigarettes, aes(x=1, y=Sales)) + geom_boxplot()
d2 <- ggplot(cigarettes, aes(x=1, y=Age)) + geom_boxplot()
d3 <- ggplot(cigarettes, aes(x=1, y=Income)) + geom_boxplot()
d4 <- ggplot(cigarettes, aes(x=1, y=Price)) + geom_boxplot()
multiplot(d1, d2, d3, d4, cols=2)
rm(d1, d2, d3, d4)
hist(cigarettes$Sales)
hist(filteredcigarettes$Sales)
hist(filteredcigarettes$Sales,breaks=10)
hist(filteredcigarettes$Sales,breaks=20)
hist(filteredcigarettes$Sales^(1/2),breaks=20)
hist(log(filteredcigarettes$Sales),breaks=20)
hist(log(filteredcigarettes$Sales),breaks=10)
hist(filteredcigarettes$Sales^(2),breaks=20)
hist(filteredcigarettes$Sales^(3),breaks=20)
hist(filteredcigarettes$Sales^(4),breaks=20)
hist(filteredcigarettes$Sales^(3),breaks=20)
model <- lm(I(Sales^3) ~ Age + poly(Income,2) + Price + Region, data=filteredcigarettesregion)
summary(model)
plot(model)
model <- lm(I(Sales^3) ~ Age + I(Income^2) + Price + Region, data=filteredcigarettesregion)
summary(model)
Plot(model)
plot(model)
model
model <- lm(Sales ~ Age + poly(Income,2) + Price + Region, data=filteredcigarettesregion)
library(MASS)
boxcox(model,plotit=T,lambda = seq(-10,10,by=0.1))
summary(model)
model <- lm(I(Sales^2.5) ~ Age + poly(Income,2) + Price + Region, data=filteredcigarettesregion)
summmary(model)
summary(model)
model <- lm(Sales ~ Age + poly(Income,2) + Price + Region, data=filteredcigarettesregion)
summary(model)
gala
library(faraway)
gala
data(gala)
gala
model <- lm(Species ~ Endemics + Area + Elevation + Nearest + Scruz + Adjacent, data=gala)
summary(model)
cor(gala)
model <- lm(Species ~ Area + Elevation + Nearest + Scruz + Adjacent, data=gala)
summary(model)
library(MASS)
boxcox(model, plotit=T)
library(MASS)
library(ggplot2)
library(MASS)
library(knitr)
library(dplyr)
library(faraway)
gala
gala <- gala
select(gala, Species)
dplyr::select(gala, Species)
library(ggplot2)
library(MASS)
library(knitr)
library(dplyr)
setwd("/Users/Charley/Downloads/cuny/IS 621 Business Analytics and Data Mining/Homework 1")
cigarettes <- read.csv("cigarette-training-data.csv")
northeast <- c("ME", "NH", "VT", "MA", "RI", "CT", "NY", "PA", "NJ")
midwest <- c("ND", "SD", "NE", "KS", "MN", "IA", "MO", "IL", "WI", "MI",
"IN", "OH", "IO", "KA", "NB")
south <- c("DE", "MD", "DC", "WV", "VA", "KY", "NC", "TN", "SC", "GA",
"AL","MS","AR","LA","OK","TX", "FL")
west <- c("WA", "OR", "ID", "MT", "WY", "CA", "NV", "UT", "CO", "AZ", "NM", "AK", "HI")
regionlookup <- rbind(data.frame(Region = "Northeast", State = northeast),
data.frame(Region = "Midwest", State = midwest),
data.frame(Region = "South", State = south),
data.frame(Region = "West", State = west))
cigarettesregion <- merge(cigarettes,regionlookup, by="State")
filteredcigarettes <- filter(cigarettes, Sales < 135 & Sales > 82)
filteredcigarettesregion <- merge(filteredcigarettes,regionlookup, by="State")
rm(midwest, northeast, south, west, regionlookup)
model <- lm(Sales ~ Age + I(Income^2) + Price + Region)
model <- lm(Sales ~ Age + I(Income^2) + Price + Region, data=cigarettesregion)
summary(model)
plot(model)
model <- lm(Sales ~ Age + I(Income^2) + Price + Region, data=filteredcigarettesregion)
summary(model)
boxcox(model,plotit=T,lambda=seq(-10,10,by=0.1))
model <- lm(I(Sales^3) ~ Age + I(Income^2) + Price + Region, data=filteredcigarettesregion)
summary(model)
plot(model)
plot(model,which=1)
plot(model,which=2)
plot(model,which=3)
plot(model,which=4)
model <- lm(I((Sales^3 - 1)/3) ~ Age + I(Income^2) + Price + Region, data=filteredcigarettesregion)
summary(model)
model <- lm(Sales ~ Age + I(Income^2) + Price + Region, data=filteredcigarettesregion)
boxcox(model,plotit=T,lambda = seq(0,1,by=0.05))
boxcox(model,plotit=T,lambda = seq(0,3,by=0.05))
boxcox(model,plotit=T,lambda = seq(0,5,by=0.05))
model <- lm(I((Sales^3 - 1)/3) ~ Age + I(Income^2) + Price + Region, data=filteredcigarettesregion)
model <- lm(Sales ~ Age + I(Income^2) + Price + Region, data=filteredcigarettesregion)
summary(model)
model <- lm(I((Sales^3 - 1)/3) ~ Age + I(Income^2) + Price + Region, data=filteredcigarettesregion)
summary(model)
model <- lm(I((Sales^3 - 1)/3) ~ Age + I(Income^2) + Price, data=filteredcigarettesregion)
summary(model)
model <- lm(I((Sales^3 - 1)/3) ~ Age + poly(Income,2) + Price, data=filteredcigarettesregion)
summary(model)
model <- lm(I((Sales^3 - 1)/3) ~ Age + I(Income^2) + Price, data=filteredcigarettesregion)
summary(model)
gala
model <- lm(Species ~ Area + Elevation + Nearest + Scruz + Adjacent, data=gala)
summary(model)
library(MASS)
boxcox(model, plotit=T)
model <- lm(I(Species^(1/3)) ~ Area + Elevation + Nearest + Scruz + Adjacent, data=gala)
summary(model)
gala
model <- lm(Species ~ Area + Elevation + Nearest + Scruz + Adjacent, data=gala)
summary(model)
library(MASS)
boxcox(model, plotit=T)
model2 <- lm(I(Species^(1/3)) ~ Area + Elevation + Nearest + Scruz + Adjacent, data=gala)
summary(model2)
model2 <- lm(I(Species^(1/3)) ~ Area + Elevation + Scruz + Adjacent, data=gala)
summary(model2)
model2 <- lm(I(Species^(1/3)) ~ Area + Elevation + Adjacent, data=gala)
summary(model2)
gala <- gala
gala$Species13 <- gala$Species^(1/3)
gala <- gala
model <- lm(Species ~ Area + Elevation + Nearest + Scruz + Adjacent, data=gala)
summary(model)
library(MASS)
boxcox(model, plotit=T)
model2 <- lm(I(Species^(1/3)) ~ Area + Elevation + Nearest + Scruz + Adjacent, data=gala)
summary(model2)
gala$Species13 <- gala$Species^(1/3)
model3 <_ lm(Species13 ~ Area + Elevation + Nearest + Scruz + Adjacent, data=gala)
summary(model3)
gala <- gala
model <- lm(Species ~ Area + Elevation + Nearest + Scruz + Adjacent, data=gala)
summary(model)
library(MASS)
boxcox(model, plotit=T)
model2 <- lm(I(Species^(1/3)) ~ Area + Elevation + Nearest + Scruz + Adjacent, data=gala)
summary(model2)
gala$Species13 <- gala$Species^(1/3)
model3 <- lm(Species13 ~ Area + Elevation + Nearest + Scruz + Adjacent, data=gala)
summary(model3)
g1 <- ggplot(cigarettes, aes(x = Age)) + geom_histogram()
library(ggplot2)
library(MASS)
library(knitr)
library(dplyr)
setwd("/Users/Charley/Downloads/cuny/IS 621 Business Analytics and Data Mining/Homework 1")
cigarettes <- read.csv("cigarette-training-data.csv")
northeast <- c("ME", "NH", "VT", "MA", "RI", "CT", "NY", "PA", "NJ")
midwest <- c("ND", "SD", "NE", "KS", "MN", "IA", "MO", "IL", "WI", "MI",
"IN", "OH", "IO", "KA", "NB")
south <- c("DE", "MD", "DC", "WV", "VA", "KY", "NC", "TN", "SC", "GA",
"AL","MS","AR","LA","OK","TX", "FL")
west <- c("WA", "OR", "ID", "MT", "WY", "CA", "NV", "UT", "CO", "AZ", "NM", "AK", "HI")
regionlookup <- rbind(data.frame(Region = "Northeast", State = northeast),
data.frame(Region = "Midwest", State = midwest),
data.frame(Region = "South", State = south),
data.frame(Region = "West", State = west))
cigarettesregion <- merge(cigarettes,regionlookup, by="State")
filteredcigarettes <- filter(cigarettes, Sales < 135 & Sales > 82)
filteredcigarettesregion <- merge(filteredcigarettes,regionlookup, by="State")
rm(midwest, northeast, south, west, regionlookup)
g1 <- ggplot(cigarettes, aes(x = Age)) + geom_histogram()
ggplot(cigarettes, aes(x = Age)) + geom_histogram()
g2 <- ggplot(cigarettes, aes(x = Income)) + geom_histogram()
ggplot(cigarettes, aes(x = Income)) + geom_histogram()
g3 <- ggplot(cigarettes, aes(x = Price)) + geom_histogram()
g1 <- ggplot(cigarettes, aes(x = Age)) + geom_histogram()
g2 <- ggplot(cigarettes, aes(x = Income)) + geom_histogram()
g3 <- ggplot(cigarettes, aes(x = Price)) + geom_histogram()
g4 <- ggplot(cigarettes, aes(x = Sales)) + geom_histogram()
multiplot(g1, g2, g3, cols=2)
rm(g1, g2, g3)
multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
library(grid)
# Make a list from the ... arguments and plotlist
plots <- c(list(...), plotlist)
numPlots = length(plots)
# If layout is NULL, then use 'cols' to determine layout
if (is.null(layout)) {
# Make the panel
# ncol: Number of columns of plots
# nrow: Number of rows needed, calculated from # of cols
layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
ncol = cols, nrow = ceiling(numPlots/cols))
}
if (numPlots==1) {
print(plots[[1]])
} else {
# Set up the page
grid.newpage()
pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
# Make each plot, in the correct location
for (i in 1:numPlots) {
# Get the i,j matrix positions of the regions that contain this subplot
matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
layout.pos.col = matchidx$col))
}
}
}
g1 <- ggplot(cigarettes, aes(x = Age)) + geom_histogram()
g2 <- ggplot(cigarettes, aes(x = Income)) + geom_histogram()
g3 <- ggplot(cigarettes, aes(x = Price)) + geom_histogram()
g4 <- ggplot(cigarettes, aes(x = Sales)) + geom_histogram()
multiplot(g1, g2, g3, g4, cols=2)
rm(g1, g2, g3, g4)
g1 <- ggplot(filteredcigarettes, aes(x = Age)) + geom_histogram()
g2 <- ggplot(filteredcigarettes, aes(x = Income)) + geom_histogram()
g3 <- ggplot(filteredcigarettes, aes(x = Price)) + geom_histogram()
g4 <- ggplot(filteredcigarettes, aes(x = Sales)) + geom_histogram()
multiplot(g1, g2, g3, g4, cols=2)
rm(g1, g2, g3, g4)
g1 <- ggplot(filteredcigarettes, aes(x = Age)) + geom_histogram()
g2 <- ggplot(filteredcigarettes, aes(x = Income)) + geom_histogram()
g3 <- ggplot(filteredcigarettes, aes(x = Price)) + geom_histogram()
g4 <- ggplot(filteredcigarettes, aes(x = Sales^3)) + geom_histogram()
multiplot(g1, g2, g3, g4, cols=2)
rm(g1, g2, g3, g4)
g1 <- ggplot(filteredcigarettes, aes(x = Age)) + geom_histogram()
g2 <- ggplot(filteredcigarettes, aes(x = Income)) + geom_histogram()
g3 <- ggplot(filteredcigarettes, aes(x = Price)) + geom_histogram()
g4 <- ggplot(filteredcigarettes, aes(x = log(Sales))) + geom_histogram()
multiplot(g1, g2, g3, g4, cols=2)
rm(g1, g2, g3, g4)
ggplot(filteredcigarettes, aes(x = Sales^3)) + geom_histogram()
ggplot(filteredcigarettes, aes(x = Sales)) + geom_histogram()
ggplot(filteredcigarettes, aes(x = Sales^(1/3))) + geom_histogram()
g4 <- ggplot(filteredcigarettes, aes(x = Sales^5) + geom_histogram()
ggplot(filteredcigarettes, aes(x = Sales^5) + geom_histogram()
ggplot(filteredcigarettes, aes(x = Sales^5) + geom_histogram()
ggplot(filteredcigarettes, aes(x = Sales^5)) + geom_histogram()
ggplot(filteredcigarettes, aes(x = Sales^5)) + geom_histogram()
ggplot(filteredcigarettes, aes(x = Sales^4)) + geom_histogram()
ggplot(filteredcigarettes, aes(x = Sales^3.5)) + geom_histogram()
model <- lm(i(Sales^4) ~ Age + Poly(Income,2) + Price + Region,
data = filteredcigarettesregion)
model <- lm(i(Sales^4) ~ Age + poly(Income,2) + Price + Region,
data = filteredcigarettesregion)
model <- lm(I(Sales^4) ~ Age + poly(Income,2) + Price + Region,
data = filteredcigarettesregion)
summary(model)
model <- lm(I(Sales^3) ~ Age + poly(Income,2) + Price + Region,
data = filteredcigarettesregion)
summary(model)
model <- lm(I(Sales^2) ~ Age + poly(Income,2) + Price + Region,
data = filteredcigarettesregion)
summary(model)
model <- lm(I(Sales^1) ~ Age + poly(Income,2) + Price + Region,
data = filteredcigarettesregion)
summary(model)
model <- lm(Sales ~ Age + poly(Income,2) + Price + Region,
data = filteredcigarettesregion)
summary(model)
plot(model)
cigarettes <- read.csv("cigarette-training-data.csv")
northeast <- c("ME", "NH", "VT", "MA", "RI", "CT", "NY", "PA", "NJ")
midwest <- c("ND", "SD", "NE", "KS", "MN", "IA", "MO", "IL", "WI", "MI",
"IN", "OH", "IO", "KA", "NB")
south <- c("DE", "MD", "DC", "WV", "VA", "KY", "NC", "TN", "SC", "GA",
"AL","MS","AR","LA","OK","TX", "FL")
west <- c("WA", "OR", "ID", "MT", "WY", "CA", "NV", "UT", "CO", "AZ", "NM", "AK", "HI")
regionlookup <- rbind(data.frame(Region = "Northeast", State = northeast),
data.frame(Region = "Midwest", State = midwest),
data.frame(Region = "South", State = south),
data.frame(Region = "West", State = west))
cigarettesregion <- merge(cigarettes,regionlookup, by="State")
filteredcigarettes <- filter(cigarettes, Sales < 135 & Sales > 83)
filteredcigarettesregion <- merge(filteredcigarettes,regionlookup, by="State")
rm(midwest, northeast, south, west, regionlookup)
model <- lm(Sales ~ Age + poly(Income,2) + Price + Region,
data = filteredcigarettesregion)
summary(model)
plot(model)
?IQR
IQR(cigarettes$Sales)
mean(cigarettes$Sales)
mean(cigarettes$Sales)-IQR(cigarettes$Sales)
mean(cigarettes$Sales)-2*IQR(cigarettes$Sales)
