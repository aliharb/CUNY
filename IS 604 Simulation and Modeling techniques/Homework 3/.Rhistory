ggplot(results,aes(x=as.factor(n), y=mean, fill=method)) + geom_bar(stat="identity", position="dodge")
```
ggplot(resultsagg,aes(x=as.factor(n), y=mean, fill=method)) + geom_bar(stat="identity", position="dodge")
ggplot(resultsagg,aes(x=as.factor(n), y=sd, fill=method)) +
geom_bar(stat="identity", position="dodge")
ggplot(resultsagg,aes(x=n, y=sd, color=method)) + geom_line()
ggplot(resultsagg,aes(x=as.factor(n), y=sd, fill=method)) +
geom_bar(stat="identity", position="dodge")
ggplot(resultsagg,aes(x=n, y=system.time, color=method))
ggplot(resultsagg,aes(x=n, y=system.time, fill=method)) + geom_line()
ggplot(resultsagg,aes(x=n, y=system.time, color=method)) + geom_line()
ggplot(resultsagg,aes(x=as.facttor(n), y=sd, fill=method)) +
geom_bar(stat="identity", position="dodge")
ggplot(resultsagg,aes(x=as.factor(n), y=sd, fill=method)) +
geom_bar(stat="identity", position="dodge")
ggplot(resultsagg,aes(x=as.factor(n), y=system.time, fill=method)) +
geom_bar(stat="identity", position="dodge")
ggplot(resultsagg,aes(x=n, y=system.time, color=method)) + geom_line()
ggplot(resultsagg,aes(x=as.factor(n), y=system.time, fill=method)) +
geom_bar(stat="identity", position="dodge")
x <- runif(5000)
rv <- (2*x - 1)^3
rv <- -((2*x - 1)^3)
x <- runif(5000)
rv <- (2*x - 1)^3
xneg <- runif(5000)
rvneg <- -((2*x - 1)^3)
x <- runif(5000)
rv <- (2*x - 1)^3
x <- runif(5000)
rv <- (2*x)^(1/3)
x <- runif(5000)
rv <- (2*x)^(1/3)
xneg <- runif(5000)
rvneg <- -((2*x)^(1/3))
rv <- c(rv,rvneg)
hist(rv)
x <- runif(5000)
rv <- (2*x)^(1/3)
hist(rv)
2^(1/3)
x <- seq(0,1,by=0.1)
y <- (2*x)^(1/3)
plot(x,y)
x <- runif(5000)
rv <- x^(1/3)
xneg <- runif(5000)
rvneg <- -(x^(1/3))
rv <- c(rv,rvneg)
hist(rv)
sample(c(1,-1),10000,replace=TRUE)
neg <- sample(c(1,-1),10000,replace=TRUE)
x <- runif(10000)
x <- x*neg
rv <- x^(1/3)
x <- runif(10000)
rv <- x^(1/3)
rv <- neg*(x^(1/3))
neg <- sample(c(1,-1),10000,replace=TRUE)
rv <- neg*(x^(1/3))
hist(rv)
x <- runif(5000)
rv <- x^(1/3)
xneg <- runif(5000)
rvneg <- -(x^(1/3))
rv <- c(rv,rvneg)
hist(rv)
neg <- sample(c(1,-1),10000,replace=TRUE)
x <- runif(10000)
rv <- neg*(x^(1/3))
hist(rv)
x <- runif(5000)
rv <- x^(1/3)
xneg <- runif(5000)
rvneg <- -(x^(1/3))
rv <- c(rv,rvneg)
hist(rv)
x <- 0
for(i in 1:7){
x <- c(x,(tail(x,1) + 12) %% 13)
}
x
x <- 0
for(i in 1:14){
x <- c(x,(tail(x,1) + 12) %% 13)
}
x
x <- 0
for(i in 1:100){
x <- c(x,(tail(x,1) + 12) %% 13)
}
x
x <- 1
for(i in 1:100){
x <- c(x,(tail(x,1) + 12) %% 13)
}
x
x
x <- 3
for(i in 1:25){
x <- c(x,(tail(x,1) + 12) %% 13)
}
x
x <- 0
for(i in 1000){
x <- c(x,(tail(x,1) + 12) %% 13)
}
library(ggplot2)
data <- data.frame(x=head(x,-1), y=tail(x, -1))
View(data)
x <- 0
for(i in 1000){
x <- c(x,(tail(x,1) + 12) %% 13)
}
head(x,-1)
head(x,1)
tail(x, -1)
tail(x)
head(x)
x
x <- 0
for(i in 1:1000){
x <- c(x,(tail(x,1) + 12) %% 13)
}
data <- data.frame(x=head(x,-1), y=tail(x, -1))
View(data)
ggplot(data,aes(x=x,y=y)) + geom_point()
insidecircle <- function(x,y){
if(x^2 + y^2 < 1){
return(1)
}else{
return(0)
}
}
if(1)
{print(hello)}
if(1){print("hello")}
if(0){print("hello")}
x <- runif(100)
y <- runif(100)
ifelse(insideccircle(x,y),1,0)
insidecircle <- function(x,y){
if(x^2 + y^2 < 1){
return(1)
}else{
return(0)
}
}
ifelse(insideccircle(x,y),1,0)
ifelse(insidecircle(x,y),1,0)
data <- data.frame(x=x,y=y,insidecircle = insidecircle(x,y))
x <- runif(N)
y <- runif(N)
data <- data.frame(x=x,y=y,insidecircle = insidecircle(x,y))
insidecircle <- function(x,y){
ifelse(x^2 + y^2 < 1,return(1),return(0))
}
data <- data.frame(x=x,y=y,insidecircle = insidecircle(x,y))
View(data)
x^2 + y^2 < 1
ifelse(x^2 + y^2 < 1,return(1),return(0))
insidecircle(.5,.5)
insidecircle(.1,.1)
insidecircle <- function(x,y){
if(x^2 + y^2 < 1){
return(1)
}else{
return(0)
}
}
insidecirrcle(.1,.1)
insidecircle(.1,.1)
insidecircle <- function(x,y){
ifelse(x^2 + y^2 < 1,return(1),return(0))
}
insidecircle(.9,.9)
data <- data.frame(x=x,y=y)
library(dplyr)
data %>% mutate(inside = insidecircle(x,y))
insidecircle(.9,.9)
estimatepi <- function(N){
x <- runif(N)
y <- runif(N)
data <- data.frame(x=x,y=y)
}
N <- 10000
x <- runif(N)
y <- runif(N)
data <- data.frame(x=x,y=y)
data %>% mutate(inside = insidecircle(x,y))
View(data)
insidecircle(.92,.62)
apply(data, 1, insidecircle(x,y))
apply(data, 1, function(x) insidecircle(x[1],x[2]))
x <- runif(N)
y <- runif(N)
data <- data.frame(x=x,y=y,inside=apply(data, 1, function(x) insidecircle(x[1],x[2])))
View(data)
x <- c(7.3,6.1,3.8,8.4,6.9,7.1,5.3,8.2,4.9,5.8)
xbar <- mean(x)
x-xbar
sum(x-xbar)^2
sum(x-xbar)
x-xbar
sum((x-xbar)^2)
sum((x-xbar)^2)/(10-1)
(6.38+1.96*2.1617)/sqrt(10)
(6.38-1.96*2.1617)/sqrt(10)
qt(.95,15)
qt(.95,14)
pt(.95,15)
pt(.95,14)
pt(.95,df=14)
dt(.95,15)
x <- runif(N)
y <- runif(N)
N = 10000
x <- runif(N)
y <- runif(N)
data <- data.frame(x=x,y=y,inside=apply(data, 1, function(x) insidecircle(x[1],x[2])))
insidecircle <- function(x,y){
ifelse(x^2 + y^2 < 1,return(1),return(0))
}
data <- data.frame(x=x,y=y,inside=apply(data, 1, function(x) insidecircle(x[1],x[2])))
data <- data.frame(x=x,y=y)
data$inside <- apply(data,1,function(x) insidecircle(x[1],x[2]))
View(data)
moe <- 1.96*sd(data$inside)/sqrt(N)
piest <- 4*sum(data$inside)/length(data$inside)
sqrt(2.1617)
x <- c(1,2,3,4,5)
mean(x)
mean(4*x)
sd(x*4)
sd(x)
sd(x*4)
sd(1,2,3)
sd(c(1,2,3))
mean(c(1,2,3))
mean(c(1-2,2-2,3-2)/2)
mean(c(1-2,2-2,3-2)/3)
mean(c(1-2,2-2,3-2))
?sd
x
sd(x)
mean(x)
mean(mean(x)-x)
mean(x-mean(x))
var(x)
mean((x-mean(x))^2)
mean((x-mean(x))^2)/4
mean((x-mean(x))^2)
sum((x-mean(x))^2)/(n-1)
sum((x-mean(x))^2)/4
mean <- sum(data$inside)/length(data$inside)
var <- sum(((data$inside-mean)^2)/(length(data$inside)-1))
se <- sqrt(var)
moe <- (1.96*se)/sqrt(length(data$inside))
sd(data$inside)
sd(4*data$inside)
4*sd(data$inside)
pise <- 4*se
moe <- (1.96*pise)/sqrt(length(data$inside))
estimatepi <- function(N){
x <- runif(N)
y <- runif(N)
data <- data.frame(x=x,y=y)
data$inside <- apply(data,1,function(x) insidecircle(x[1],x[2]))
mean <- sum(data$inside)/length(data$inside)
piest <- 4*sum(data$inside)/length(data$inside)
se <- sd(data$inside)
pise <- 4*se
moe <- (1.96*pise)/sqrt(length(data$inside))
return(list(pi=piest,standard.error=se,ci95=moe))
}
estimatepi(1000)
citable <- data.frame(estimate=c(),se=c(),upper=c(),lower=c())
for(n in seq(1000,10000,by=500)){
pi <- estimatepi(n)
citable <- rbind(citable,c(pi$pi,pi$standard.error,
pi$pi+pi$ci95,pi$pi-pi$ci95))
}
View(citable)
colnames(citable)
colnames(citable) <- c("estimate", "standard.error", "upper", "lower")
View(citable)
citable <- data.frame(n=c(),estimate=c(),se=c(),upper=c(),lower=c())
citable <- data.frame(n=c(),estimate=c(),se=c(),upper=c(),lower=c())
for(n in seq(1000,10000,by=500)){
pi <- estimatepi(n)
citable <- rbind(citable,c(n,pi$pi,pi$standard.error,
pi$pi+pi$ci95,pi$pi-pi$ci95))
}
colnames(citable) <- c("estimate", "standard.error", "upper", "lower")
View(citable)
colnames(citable) <- c("Number","estimate", "standard.error", "upper", "lower")
View(citable)
citable <- data.frame(n=c(),estimate=c(),se=c(),upper=c(),lower=c(),moe=c())
for(n in seq(1000,10000,by=500)){
pi <- estimatepi(n)
citable <- rbind(citable,c(n,pi$pi,pi$standard.error,
pi$pi+pi$ci95,pi$pi-pi$ci95,pi$ci95))
}
colnames(citable) <- c("Number","estimate", "standard.error", "upper", "lower",
"MOE")
View(citable)
citable <- data.frame(n=c(),estimate=c(),se=c(),upper=c(),lower=c(),moe=c())
for(n in seq(1000,10000,by=500)){
pi <- estimatepi(n)
citable <- rbind(citable,c(n,pi$pi,pi$standard.error,
pi$pi+pi$ci95,pi$pi-pi$ci95,pi$ci95))
}
colnames(citable) <- c("Number","estimate", "standard.error", "upper", "lower",
"MOE")
View(citable)
citable <- data.frame(n=c(),estimate=c(),se=c(),upper=c(),lower=c(),moe=c())
for(n in seq(1000,10000,by=500)){
pi <- estimatepi(n)
citable <- rbind(citable,c(n,pi$pi,pi$standard.error,
pi$pi+pi$ci95,pi$pi-pi$ci95,pi$ci95))
}
colnames(citable) <- c("Number","estimate", "standard.error", "upper", "lower",
"MOE")
View(citable)
View(citable)
citable <- data.frame(n=c(),estimate=c(),se=c(),upper=c(),lower=c(),interval=c())
for(n in seq(1000,10000,by=500)){
pi <- estimatepi(n)
citable <- rbind(citable,c(n,pi$pi,pi$standard.error,
pi$pi+pi$ci95,pi$pi-pi$ci95,pi$ci95*2))
}
colnames(citable) <- c("number","estimate", "standard.error", "upper", "lower",
"interval")
View(citable)
View(citable)
citable <- data.frame(n=c(),estimate=c(),se=c(),upper=c(),lower=c(),interval=c())
for(n in seq(1000,10000,by=500)){
pi <- estimatepi(n)
citable <- rbind(citable,c(n,pi$pi,pi$standard.error,
pi$pi+pi$ci95,pi$pi-pi$ci95,pi$ci95*2))
}
colnames(citable) <- c("number","estimate", "standard.error", "upper", "lower",
"interval")
View(citable)
citable <- data.frame(n=c(),estimate=c(),se=c(),upper=c(),lower=c(),interval=c())
for(n in seq(1000,10000,by=500)){
pi <- estimatepi(n)
citable <- rbind(citable,c(n,pi$pi,pi$standard.error,
pi$pi+pi$ci95,pi$pi-pi$ci95,pi$ci95*2))
}
colnames(citable) <- c("number","estimate", "standard.error", "upper", "lower",
"interval")
View(citable)
pi <- c()
for(i in 1:500){
pi <- c(pi,estimatepi(500)$pi)
}
pi
hist(pi)
pi <- c()
for(i in 1:500){
pi <- c(pi,estimatepi(500)$pi)
}
hist(pi)
pi <- c()
for(i in 1:500){
pi <- c(pi,estimatepi(500)$pi)
}
hist(pi)
sdpi <- sd(pi)
sdpi
View(citable)
0.414804/4
estimatepi <- function(N){
x <- runif(N)
y <- runif(N)
data <- data.frame(x=x,y=y)
data$inside <- apply(data,1,function(x) insidecircle(x[1],x[2]))
mean <- sum(data$inside)/length(data$inside)
piest <- 4*sum(data$inside)/length(data$inside)
se <- sd(data$inside)
pise <- 4*se
moe <- (1.96*pise)/sqrt(length(data$inside))
return(list(pi=piest,standard.error=pise,ci95=moe))
}
citable <- data.frame(n=c(),estimate=c(),se=c(),upper=c(),lower=c(),interval=c())
for(n in seq(1000,10000,by=500)){
pi <- estimatepi(n)
citable <- rbind(citable,c(n,pi$pi,pi$standard.error,
pi$pi+pi$ci95,pi$pi-pi$ci95,pi$ci95*2))
}
colnames(citable) <- c("number","estimate", "standard.error", "upper", "lower",
"interval")
View(citable)
sd(c(1,2,3,44,6,7,8,8,4))
4*sd(c(1,2,3,44,6,7,8,8,4))
sd(4*c(1,2,3,44,6,7,8,8,4))
pi <- c()
for(i in 1:500){
pi <- c(pi,estimatepi(500)$pi)
}
hist(pi)
sdpi <- sd(pi)
sdpi
moe4500 <- filter(citable$interval, number==4500)
library(dplyr)
moe4500 <- filter(citable$interval, number==4500)
moe4500 <- moe %>% filter(citable, number==4500) %>% select(interval)
filter
?filter
moe4500 <- moe %>% filter(number==4500) %>% select(interval)
moe4500 <- citable %>% filter(number==4500) %>% select(interval)
View(moe4500)
moe4500 <- as.numeric(citable %>% filter(number==4500) %>% select(interval))
moe4500 <- as.numeric(citable %>% filter(number==4500) %>% select(interval))/2
pi[pi>mean(pi)-moe4500 & pi<mean(pi)+moe4500]
length(pi[pi>mean(pi)-moe4500 & pi<mean(pi)+moe4500])/length(pi)
x <- 1234567
r <- 1234567/(2^31 - 1)
for(i in 1:9999){
x <- c(x, (16807*tail(x,1)) %% (2^31 - 1))
r <- c(r, tail(x,1)/(2^31 - 1))
}
classes <- seq(0,1,by=1/20)
table <- data.frame(lower=head(classes,-1),upper=tail(classes,-1))
library(plyr)
loweruppercount <- function(data){
c(intervalcount = with(data, length(r[r>=lower&r<upper])))
}
chitable <- ddply(table, .variables=c("lower","upper"), .fun=loweruppercount)
chitable$chistat <- ((chitable$intervalcount - length(r)/20)^2)/(length(r)/20)
chitable
View(chitable)
View(table)
x <- 1234567
r <- 1234567/(2^31 - 1)
for(i in 1:9999){
x <- c(x, (16807*tail(x,1)) %% (2^31 - 1))
r <- c(r, tail(x,1)/(2^31 - 1))
}
classes <- seq(0,1,by=1/20)
table <- data.frame(lower=head(classes,-1),upper=tail(classes,-1))
library(plyr)
loweruppercount <- function(data){
c(intervalcount = with(data, length(r[r>=lower&r<upper])))
}
chitable <- ddply(table, .variables=c("lower","upper"), .fun=loweruppercount)
chitable$chistat <- ((chitable$intervalcount - length(r)/20)^2)/(length(r)/20)
chitable
x <- 1234567
r <- 1234567/(2^31 - 1)
for(i in 1:9999){
x <- c(x, (16807*tail(x,1)) %% (2^31 - 1))
r <- c(r, tail(x,1)/(2^31 - 1))
}
classes <- seq(0,1,by=1/20)
table <- data.frame(lower=head(classes,-1),upper=tail(classes,-1))
library(plyr)
loweruppercount <- function(data){
c(intervalcount = with(data, length(r[r>=lower&r<upper])))
}
chitable <- ddply(table, .variables=c("lower","upper"), .fun=loweruppercount)
chitable$chistat <- ((chitable$intervalcount - length(r)/20)^2)/(length(r)/20)
chitable
r
r
runs <- ifelse(head(r,-1)<tail(r,-1),1,-1)
runs
length(runs)
sum(head(runs,-1)!=tail(runs,-1))
sum(head(runs,-1)!=tail(runs,-1))/length(runs)
S
S <- sum(head(runs,-1)!=tail(runs,-1))/length(runs)
S
S <- sum(head(runs,-1)!=tail(runs,-1))
S
(2*length(runs)-1)/3
(2*length(r)-1)/3
Es <- (2*length(r)-1)/3
chisquare <- sum(chitable$chistat)
chisquare
chisquare
View(chitable)
MOE <- (1.96*sd(chitabe$chistat))/sqrt(20)
MOE <- (1.96*sd(chitable$chistat))/sqrt(20)
chisquare
MOE <- (1.96*sd(chitable$chistat))/sqrt(length(chitable$chistat))
length(r)
length(r)/length(chitable$chistat)
chisquare
chisquare
S <- sum(head(runs,-1)!=tail(runs,-1))
S
Es <- (2*length(r)-1)/3
Es
(1.96*sd(r))/sqrt(length(r))
Es <- (2*length(r)-1)/3
Es
S <- sum(head(runs,-1)!=tail(runs,-1))
S
S <- sqrt((16*length(r)-29)/90)
Es/S
Es <- (2*length(r)-1)/3
S <- sqrt((16*length(r)-29)/90)
S <- sqrt((16*length(r)-29)/90)
Es/S
MOE <- (1.96*sd(r))/sqrt(length(r))
S <- sum(head(runs,-1)!=tail(runs,-1))
S
Se <- sqrt((16*length(r)-29)/90)
(S-Es)/Se
MOE <- (S-Es)/Se
